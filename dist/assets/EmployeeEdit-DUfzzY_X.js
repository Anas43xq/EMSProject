import{u as _,s as c,j as e}from"./index-BBL5zgFY.js";import{f as w,u as C,r as d,L as x}from"./vendor-5bkAA5gm.js";import{A as k,q as S}from"./lucide-cejH3fEv.js";import"./pdf-BwXo9bY9.js";import"./supabase-CQnWzhEg.js";function L(){const{id:n}=w(),i=C(),{showNotification:o}=_(),[b,g]=d.useState(!0),[m,u]=d.useState(!1),[y,h]=d.useState([]),[a,p]=d.useState({employee_number:"",first_name:"",last_name:"",email:"",phone:"",date_of_birth:"",gender:"",address:"",city:"",state:"",postal_code:"",department_id:"",position:"",employment_type:"full-time",status:"active",hire_date:"",termination_date:"",salary:"",emergency_contact_name:"",emergency_contact_phone:""});d.useEffect(()=>{f(),n&&j()},[n]);const f=async()=>{try{const{data:t,error:r}=await c.from("departments").select("id, name").order("name");if(r)throw r;h(t||[])}catch(t){console.error("Error loading departments:",t),o("error","Failed to load departments")}},j=async()=>{var t;try{const{data:r,error:l}=await c.from("employees").select("*").eq("id",n).maybeSingle();if(l)throw l;if(!r){o("error","Employee not found"),i("/employees");return}p({employee_number:r.employee_number||"",first_name:r.first_name||"",last_name:r.last_name||"",email:r.email||"",phone:r.phone||"",date_of_birth:r.date_of_birth||"",gender:r.gender||"",address:r.address||"",city:r.city||"",state:r.state||"",postal_code:r.postal_code||"",department_id:r.department_id||"",position:r.position||"",employment_type:r.employment_type||"full-time",status:r.status||"active",hire_date:r.hire_date||"",termination_date:r.termination_date||"",salary:((t=r.salary)==null?void 0:t.toString())||"",emergency_contact_name:r.emergency_contact_name||"",emergency_contact_phone:r.emergency_contact_phone||""})}catch(r){console.error("Error loading employee:",r),o("error","Failed to load employee details"),i("/employees")}finally{g(!1)}},s=t=>{const{name:r,value:l}=t.target;p(N=>({...N,[r]:l}))},v=async t=>{if(t.preventDefault(),!a.first_name||!a.last_name||!a.email||!a.position){o("error","Please fill in all required fields");return}u(!0);try{const r={...a,salary:a.salary?parseFloat(a.salary):null,termination_date:a.termination_date||null,date_of_birth:a.date_of_birth||null,updated_at:new Date().toISOString()},{error:l}=await c.from("employees").update(r).eq("id",n);if(l)throw l;o("success","Employee updated successfully"),i(`/employees/${n}`)}catch(r){console.error("Error updating employee:",r),o("error",r.message||"Failed to update employee")}finally{u(!1)}};return b?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-900"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(x,{to:`/employees/${n}`,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(k,{className:"w-6 h-6 text-gray-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Edit Employee"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Update employee information"})]})]}),e.jsxs("form",{onSubmit:v,className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Personal Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Employee Number ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",name:"employee_number",value:a.employee_number,onChange:s,required:!0,disabled:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg bg-gray-50 cursor-not-allowed"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Email ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"email",name:"email",value:a.email,onChange:s,required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["First Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",name:"first_name",value:a.first_name,onChange:s,required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Last Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",name:"last_name",value:a.last_name,onChange:s,required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone"}),e.jsx("input",{type:"tel",name:"phone",value:a.phone,onChange:s,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date of Birth"}),e.jsx("input",{type:"date",name:"date_of_birth",value:a.date_of_birth,onChange:s,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Gender"}),e.jsxs("select",{name:"gender",value:a.gender,onChange:s,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select Gender"}),e.jsx("option",{value:"male",children:"Male"}),e.jsx("option",{value:"female",children:"Female"}),e.jsx("option",{value:"other",children:"Other"})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Address"}),e.jsx("input",{type:"text",name:"address",value:a.address,onChange:s,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"City"}),e.jsx("input",{type:"text",name:"city",value:a.city,onChange:s,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"State"}),e.jsx("input",{type:"text",name:"state",value:a.state,onChange:s,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Postal Code"}),e.jsx("input",{type:"text",name:"postal_code",value:a.postal_code,onChange:s,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Employment Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Department ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{name:"department_id",value:a.department_id,onChange:s,required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select Department"}),y.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Position ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",name:"position",value:a.position,onChange:s,required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Employment Type ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{name:"employment_type",value:a.employment_type,onChange:s,required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"full-time",children:"Full-time"}),e.jsx("option",{value:"part-time",children:"Part-time"}),e.jsx("option",{value:"contract",children:"Contract"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Status ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{name:"status",value:a.status,onChange:s,required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"}),e.jsx("option",{value:"on-leave",children:"On Leave"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Hire Date ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"date",name:"hire_date",value:a.hire_date,onChange:s,required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Termination Date"}),e.jsx("input",{type:"date",name:"termination_date",value:a.termination_date,onChange:s,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Salary"}),e.jsx("input",{type:"number",name:"salary",value:a.salary,onChange:s,step:"0.01",min:"0",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Emergency Contact"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Contact Name"}),e.jsx("input",{type:"text",name:"emergency_contact_name",value:a.emergency_contact_name,onChange:s,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Contact Phone"}),e.jsx("input",{type:"tel",name:"emergency_contact_phone",value:a.emergency_contact_phone,onChange:s,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]})]}),e.jsxs("div",{className:"flex items-center justify-end space-x-4",children:[e.jsx(x,{to:`/employees/${n}`,className:"px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:m,className:"flex items-center space-x-2 bg-blue-900 text-white px-6 py-2 rounded-lg hover:bg-blue-800 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:m?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),e.jsx("span",{children:"Saving..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(S,{className:"w-5 h-5"}),e.jsx("span",{children:"Save Changes"})]})})]})]})]})}export{L as default};
